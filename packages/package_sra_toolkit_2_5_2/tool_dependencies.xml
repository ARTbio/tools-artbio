<?xml version="1.0"?>
<tool_dependency>
    <package name="ascp" version="3">
        <repository name="package_ascp_3" owner="mvdbeek" />
    </package>
    <package name="ncbi_vdb" version="2.5.2">
        <repository name="package_ncbi_vdb_2_5_2" owner="mvdbeek" prior_installation_required="True" />
    </package>
    <package name="sra_toolkit" version="2.5.2">
        <install version="1.0">
            <actions>
                <action type="set_environment_for_install">
                    <repository name="package_ncbi_vdb_2_5_2" owner="mvdbeek">
                        <package name="ncbi_vdb" version="2.5.2" />
                    </repository>
                    <repository name="package_ngs_sdk_1_1_3" owner="mvdbeek">
                        <package name="ngs_sdk" version="1.1.3" />
                    </repository>
                </action>
                <action type="download_file" target_filename="sra-tools-2.5.2.tar.gz">https://github.com/ncbi/sra-tools/archive/2.5.2.tar.gz</action>
                <action type="shell_command">tar -xf sra-tools-2.5.2.tar.gz</action>
                <action type="change_directory">sra-tools-2.5.2</action>
                <action type="shell_command">
                    ./configure --prefix=$INSTALL_DIR -with-ngs-sdk-prefix=$NGS_SDK_DIR --with-ncbi-vdb-sources=$NCBI_VDB_SRC_DIR --with-ncbi-vdb-build=$NCBI_VDB_DIR --build=$INSTALL_DIR/build
                    sed -i -e "109s/-static//" tools/copycat/Makefile
                </action>
                <action type="make_install"></action>
                <action type="set_environment">
                    <environment_variable name="PATH" action="prepend_to">$INSTALL_DIR/bin</environment_variable>
                </action>
            </actions>
        </install>
        <readme>
            Tools from NCBI SRA Toolkit for extracting FASTQ and SAM format reads from SRA format archives.
            This software release was designed to run under Linux, MacOSX operating systems on Intel x86-compatible 64 bit architectures.
            When running on Amazon EC2, be sure to keep in mind the size limitation of EBS storage devices when requesting a
            download of a large SRA data set.

            Build Requirements:
            - make
            - git
            - gcc
            - g++
            - libxml2
            - libcurl4
            - zlib

            On a debian based Linux OS use:

            apt-get install build-essential libxml2-dev libcurl4-openssl-dev zlib-dev

        </readme>
    </package>
</tool_dependency>
