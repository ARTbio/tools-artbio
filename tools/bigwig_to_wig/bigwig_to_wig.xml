<tool id="bigwig_to_wig" name="BigWig to Wig" version="2.0.0">
    <description>converter</description>
    <requirements>
        <requirement type="package" version="366">ucsc-bigwiginfo</requirement>
        <requirement type="package" version="366">ucsc-bigwigsummary</requirement>
        <requirement type="package" version="1.06">bc</requirement>
  </requirements>
    <stdio>
        <exit_code range="1:" level="fatal" description="Tool exception" />
    </stdio>
    <command detect_errors="exit_code"><![CDATA[
        sh $__tool_directory__/bigwig_to_wig.sh -f $input -b $bin_size -l $mylab > $output
    ]]></command>
  <inputs>
      <param name="input" format="bigwig" type="data" label="BigWig file to convert" />
      <param name="bin_size" size="4" type="integer" value="500" label="Bin size" help="Choose the resolution (in bp) of your wig file. Must be an even integer > 100." />
      <param name="mylab" type="text" value="wiggle_file" label="Output file prefix" help="" />
  </inputs>
  <outputs>
      <data format="wig" name="output" label="${mylab}_density_bin${bin_size}.wig" />
  </outputs>
  <tests>
      <test>
	  <param name="input" value="1.bigwig" />
	  <param name="bin_size" value="500" />
	  <param name="mylab" value="wiggle_file" />
	  <output name="output" file="1.wig" />	  
      </test>
  </tests>
  <help>

This tool converts a **BigWig** file to fixed step **Wiggle** format. 
The bin size is the number of bases each value in the wiggle file represents(i.e. if the first value of the wiggle file is 20 with a bin of 500, the mean score of the 500 first bases is 20)
So the larger the bin is the more you are averaging and the faster the conversion.
	  

The script this tool is based on is written by Jens Vilstrup Johansen and uses bigWigInfo_ and bigWigSummary_.

.. _bigWigInfo: https://github.com/adamlabadorf/ucsc_tools/blob/master/executables/bigWigInfo
.. _bigWigSummary: https://github.com/adamlabadorf/ucsc_tools/blob/master/executables/bigWigSummary

</help>
</tool>
