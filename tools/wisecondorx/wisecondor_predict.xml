<tool id="wisecondorx_predict" name="WisecondorX predict" version="@WRAPPER_VERSION@" profile="@PROFILE@">
    <description>
        CNVs
    </description>
    <macros>
        <import>macro.xml</import>
    </macros>
    <expand macro="requirements"/>
    <stdio>
        <exit_code range="1:" level="fatal" description="Error occured" />
    </stdio>
    <command detect_errors="exit_code"><![CDATA[
    @pipefail@
    ln -s $npz_input sample.npz &&
    ln -s $reference reference.npz &&
    WisecondorX predict sample.npz reference.npz sample --plot --bed
    ]]></command>
    <inputs>
        <param name="npz_input" type="data" format="npz" label="npz file from sample to analyse"/>
        <param name="reference" type="data" format="npz" label="npz reference built with WisecondorX build"/>
    </inputs>
    <outputs>
        <data name="aberrations" format="bed" label="sample abberations" from_work_dir="sample_aberrations.bed"/>
        <data name="bins" format="bed" label="sample bins" from_work_dir="sample_bins.bed"/>
        <data name="segments" format="bed" label="sample segments" from_work_dir="sample_segments.bed"/>
        <data name="statistics" format="txt" label="statistics" from_work_dir="sample_statistics.txt"/>
        <collection name="plots" type="list" format="png" label="CNV plots">
            <discover_datasets pattern="__name_and_ext__" directory="sample.plots" />
        </collection>
    </outputs>
    <tests>
        <test expect_num_outputs="5">
            <param name="npz_input" value="input_sample_predict.npz" ftype="npz" />
            <param name="reference" value="input_reference_predict.10000kb.npz" />
            <output name="aberrations" ftype="bed" file="predict_abberations.bed" />
            <output name="bins" ftype="bed" file="predict_bins.bed" compare="sim_size" delta="1000"/>
            <output name="segments" ftype="bed" file="predict_segments.bed"/>
            <output name="statistics" ftype="txt" file="predict_statistics.txt" compare="sim_size" delta="1000"/>
            <output_collection name="plots" type="list" compare="sim_size" delta="1000">
                <element name="chr1" file="chr1.png"/>
                <element name="chr10" file="chr10.png"/>
                <element name="chr11" file="chr11.png"/>
                <element name="chr12" file="chr12.png"/>
                <element name="chr13" file="chr13.png"/>
                <element name="chr14" file="chr14.png"/>
                <element name="chr15" file="chr15.png"/>
                <element name="chr16" file="chr16.png"/>
                <element name="chr17" file="chr17.png"/>
                <element name="chr18" file="chr18.png"/>
                <element name="chr19" file="chr19.png"/>
                <element name="chr2" file="chr2.png"/>
                <element name="chr20" file="chr20.png"/>
                <element name="chr21" file="chr21.png"/>
                <element name="chr22" file="chr22.png"/>
                <element name="chr3" file="chr3.png"/>
                <element name="chr4" file="chr4.png"/>
                <element name="chr5" file="chr5.png"/>
                <element name="chr6" file="chr6.png"/>
                <element name="chr7" file="chr7.png"/>
                <element name="chr8" file="chr8.png"/>
                <element name="chr9" file="chr9.png"/>
                <element name="chrX" file="chrX.png"/>
                <element name="genome_wide" file="genome_wide.png"/>
            </output_collection>
        </test>
    </tests>
    <help>

WisecondorX predict
============================

Predict CNV from an input npz file, using a reference.npz generated with the tool
WisecondorX build reference.

    
Inputs
--------

A GC wigle of genome index generated with the tool "create GC_wiggle of reference genome"
available from this galaxy wrapper

A vcf file of somatic *single* nucleotide variations observed in a tumor sample


    </help>
    <citations>
        <citation type="doi">10.1093/nar/gky1263</citation>
    </citations>
</tool>
