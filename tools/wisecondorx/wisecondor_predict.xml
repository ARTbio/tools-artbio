<tool id="wisecondorx_predict" name="WisecondorX predict" version="@WRAPPER_VERSION@" profile="@PROFILE@">
    <description>
        CNVs
    </description>
    <macros>
        <import>macro.xml</import>
    </macros>
    <expand macro="requirements"/>
    <stdio>
        <exit_code range="1:" level="fatal" description="Error occured" />
    </stdio>
    <command detect_errors="exit_code"><![CDATA[
    @pipefail@
    ln -s $npz_input sample.npz &&
    ln -s $reference reference.npz &&
    WisecondorX predict sample.npz reference.npz sample --plot --bed
    ]]></command>
    <inputs>
        <param name="npz_input" type="data" format="npz" label="npz file from sample to analyse"/>
        <param name="reference" type="data" format="npz" label="npz reference built with WisecondorX build"/>
    </inputs>
    <outputs>
        <data name="aberrations" format="bed" label="sample abberations" from_work_dir="sample_aberrations.bed"/>
        <data name="bins" format="bed" label="sample bins" from_work_dir="sample_bins.bed"/>
        <data name="segments" format="bed" label="sample segments" from_work_dir="sample_segments.bed"/>
        <data name="statistics" format="txt" label="statistics" from_work_dir="sample_statistics.txt"/>
        <collection name="plots" type="list" format="png" label="CNV plots">
            discover_datasets pattern="__name_and_ext__" directory="sample.plots" />
        </collection>
    </outputs>
    <tests>
        <test>
            <param name="input_snvs" value="hg19_chr22.vcf" ftype="vcf" />
            <param name="refwig" value="hg19.GCref.txt" />
            <output name="cnvs" file="hg19.cnv.tab" ftype="tabular" />
            <output name="chrom_depths" ftype="pdf" file="hg19_chrom_depths.pdf"/>
            <output name="chrom_view" ftype="pdf" file="hg19_chrom_view.pdf"/>
            <output name="genome_view" ftype="pdf" file="hg19_genome_view.pdf"/>        
            <output name="model_fit" ftype="pdf" file="hg19_model.pdf"/>        
            <output name="CN_histo" ftype="pdf" file="hg19_CN_histo.pdf"/>        
        </test>
        <test>
            <param name="input_snvs" value="hg38_chr22.vcf" ftype="vcf" />
            <param name="refwig" value="hg38.GCref.txt" />
            <output name="cnvs" file="hg38.cnv.tab" ftype="tabular" />
            <output name="chrom_depths" ftype="pdf" file="hg38_chrom_depths.pdf"/>
            <output name="chrom_view" ftype="pdf" file="hg38_chrom_view.pdf"/>
            <output name="genome_view" ftype="pdf" file="hg38_genome_view.pdf"/>        
            <output name="model_fit" ftype="pdf" file="hg38_model.pdf"/>        
            <output name="CN_histo" ftype="pdf" file="hg38_CN_histo.pdf"/>        
        </test>
    </tests>
    <help>

WisecondorX predict
============================

Predict CNV for an input npz file, using a reference.npz generated with the tool
WisecondorX build reference.

    
Inputs
--------

A GC wigle of genome index generated with the tool "create GC_wiggle of reference genome"
available from this galaxy wrapper

A vcf file of somatic *single* nucleotide variations observed in a tumor sample


    </help>
    <citations>
        <citation type="doi">10.1093/annonc/mdu479</citation>
    </citations>
</tool>
