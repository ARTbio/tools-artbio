<tool id="wisecondorx_reference_builder" name="WisecondorX build" version="@WRAPPER_VERSION@" profile="@PROFILE@">
    <description>
        reference
    </description>
    <macros>
        <import>macro.xml</import>
    </macros>
    <expand macro="requirements"/>
    <stdio>
        <exit_code range="1:" level="fatal" description="Error occured" />
    </stdio>
    <command detect_errors="exit_code"><![CDATA[
    @pipefail@
    #for $num, $file in enumerate($npz_inputs):
        printf "$num\n" &&
        ln -s $file "${num}.npz" &&
    #end for
    WisecondorX newref *.npz reference.npz
        --binsize ${bin}
        --cpus \${GALAXY_SLOTS:-4} &&
    mv reference.npz $npz
    ]]></command>
    <inputs>
        <param name="npz_inputs" type="data" label="npz inputs" multiple="True" format="npz"
               help="Build reference from npz inputs from normal sample (at least 10 samples required)"/>
        <param name="bin" size="9" type="integer" value="100000" label="Bin size in nucleotides"
               help="Bin default value is 100 kb (100000)" />
     </inputs>
    <outputs>
        <data name="npz" format="npz" label="reference_${bin}nt" />
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help>

WisecondorX build reference
============================

Generate reference npz index from npz control samples.

Inputs
--------

A collection of .npz files (at least 10 files or more)

    </help>
    <citations>
        <citation type="doi">10.1093/nar/gky1263</citation>
    </citations>
</tool>
