<tool id="cat_multi_datasets" name="Concatenate multiple datasets" version="1.0">
    <description>tail-to-head by specifying how</description>
    <command><![CDATA[
        #if $headers == "No":
            cat
            #for $file in $input
                "$file"
            #end for
            > "$out_file1"
        #else:
            #for $file in $input
                printf "# ${file.element_identifier}\n" >> "$out_file1" &&
                cat "$file" >> "$out_file1" &&
            #end for
            sleep 1
        #end if
        ]]>
    </command>
    <inputs>
        <conditional name="global_condition">
            <param name="input_type" type="select" label="What type of data do you wish to concatenate?" help="Depending on the type of input selected the concatenation options will differ">
                <option value="singles">Single datasets</option>
                <option value="collections">Datasets in collections</option>
                <option value="paired_collections">Datasets in paired collections</option>
                <option value="nested_collections">Datasets in nested collections</option>
            </param>
            <when value="singles">
                <param name="inputs" type="data" label="Concatenate Datasets" multiple="True" help="All inputed datasets will be concatenated tail-to-head."/>
            </when>
            <when value="collections">
                <param name="inputs" type="data_collection" label="Input collections with datasets to concatenate" multiple="True" help="Select collections to concatenate into a single dataset"/>
            </when>
            <when value="paired_collections">
                <param name="inputs" type="data_collection" collection_type="paired" label="Input paired collections to concatenate"/>
                <param name="paired_cat_type" type="select" label="What type of concatenation do you wish to perform?">
                        <option value="by_strand">Concatenate all datsets of same strand (outputs a single pair of datasets)</option>
                        <option value="by_pair">Concatenate pairs of datasets (outputs an unpaired collection of datasets)</option>
                        <option value="all">Concatenate all datasets into a single file regardless of strand (outputs a single file)</option>
                </param>
            </when>
            <when value="nested_collections">
                <param name="inputs" type="data_collection" label="Select the nested collection to concatenate datasets from"/>
                <param name="level" type="integer" label="Select at wich level do you wish to concatenate the datasets." help="Refer to help for a detailed example of how this option works."/>
            </when>
        </conditional>
        <param name="headers" type="select" label="include dataset names">
            <option value="No" selected="true">No</option>
            <option value="Yes">Yes</option>
        </param>
    </inputs>
    <outputs>
        <data name="out_file1" format_source="input" metadata_source="input"/>
    </outputs>
    <tests>
        <!--<test>
            <param name="headers" value="No" />
            <param name="input" value="1.bed,2.bed"/>
            <output name="out_file1" file="cat_wrapper_out1.bed"/>
        </test>
        <test>
            <param name="headers" value="Yes" />
            <param name="input" value="1.bed,2.bed"/>
            <output name="out_file1" file="cat_wrapper_out2.bed"/>
        </test>-->
    </tests>
    <help>

.. class:: warningmark

**WARNING:** This tool does not check if the datasets being concatenated are in the same format.

-----

**What it does**

Concatenates datasets

-----

**Example**

Concatenating Dataset::

    chrX  151087187  151087355  A  0  -
    chrX  151572400  151572481  B  0  +

with Dataset1::

    chr1  151242630  151242955  X  0  +
    chr1  151271715  151271999  Y  0  +
    chr1  151278832  151279227  Z  0  -

and with Dataset2::

    chr2  100000030  200000955  P  0  +
    chr2  100000015  200000999  Q  0  +

will result in the following::

    chrX  151087187  151087355  A  0  -
    chrX  151572400  151572481  B  0  +
    chr1  151242630  151242955  X  0  +
    chr1  151271715  151271999  Y  0  +
    chr1  151278832  151279227  Z  0  -
    chr2  100000030  200000955  P  0  +
    chr2  100000015  200000999  Q  0  +

-----

Adapted from galaxy's catWrapper.xml to allow multiple input files.

    </help>
</tool>
