<tool id="small_rna_map" name="small rna map" version="0.0.1">
  <description></description>
  <requirements>
        <requirement type="package" version="1.11.2=py27_0">numpy</requirement>
        <requirement type="package" version="0.11.2.1=py27_0">pysam</requirement>
        <requirement type="package" version="1.3.2=r3.3.1_0">r-optparse</requirement>
        <requirement type="package" version="2.2.1=r3.3.1_0">r-ggplot2</requirement>
        <requirement type="package" version="2.2.1=r3.3.1_0">r-gridextra</requirement>
  </requirements>
  <stdio>
      <exit_code range="1:" level="fatal" description="Tool exception" />
  </stdio>
  <command detect_errors="exit_code"><![CDATA[
      python '$__tool_directory__'/small_rna_map.py 
      --input 
      #for $i in $input.series
            '$i.input'
      #end for 
      --output '$output_tab'
      ; Rscript '$__tool_directory__'/small_rna_map.r --output_tab '$output_tab' --output_pdf '$output_pdf'
  ]]></command>
 <inputs>
   <repeat name="series" title="Add alignment files">
       <param name="input" type="data" format="bam" label="Select multiple alignments to parse" multiple="True"/>            
       </param>
                    
   </repeat>    
 </inputs>

 <outputs>
   <data format="tabular" name="output_tab" label="tabular file" />
   <data format="pdf" name="output_pdf" label="PDF file" />
</outputs>

    <tests>
        <test>
            <param name="input" value="input.bam" ftype="bam"/>
            <output file="output.tab" name="output_tab" />
            <output file="output.pdf" name="output_pdf" />
        </test>
    </tests>


<help>

**What it does**

Generate from BAM file, a tabular file containing 9 columns:
Dataset	Chromosome	Chrom_length	Coordinate	Nbr-reads	Polarity	Max	Mean	Median	

</help>

<citations>
    <citation type="doi">10.1093/bioinformatics/btp352</citation>
     <citation type="bibtex">@Book{,
    author = {Hadley Wickham},
    title = {ggplot2: Elegant Graphics for Data Analysis},
    publisher = {Springer-Verlag New York},
    year = {2009},
    isbn = {978-0-387-98140-6},
    url = {http://ggplot2.org},
   }</citation>
</citations>
</tool>

