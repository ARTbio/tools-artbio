<tool id="lumpy_smoove" name="lumpy_smoove" version="0.1.0">
    <description>find structural variants using the smoove workflow</description>
    <macros>
        <import>macro_lumpy_smoove.xml</import>
    </macros>
    <requirements>
        <requirement type="package" version="0.2.5">smoove</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" level="fatal" description="Tool exception" />
    </stdio>
    <command detect_errors="exit_code"><![CDATA[
    @VERSION@
    @pipefail@
    @set_fasta_index@
    
        ## smoove call -x --name output --exclude exclude.cnvnator_100bp.GRCh38.20170403.bed  --fasta hg38-integragen.fa -p 24 --genotype *.bam



    ]]></command>
    <inputs>
        <expand macro="reference_source_conditional" />
        <param format="bam" name="normal_bam" type="data" label="BAM alignments from the normal sample"/>
        <param format="bam" name="tumor_bam" type="data" label="BAM alignments from the tumor sample"/>
        <param format="bed" name="bedmask" type="data" label="BED regions to be excluded for the analysis"/>        
    </inputs>

    <outputs>
        <data format="vcf" name="vcf_call" label="lumpy-smoove Variant Calling">
        </data>
    </outputs>

    <tests>
    </tests>

    <help>

**Input(s)**

*One sample* : lumpy search structural variations inside a single sequencing dataset

*Two samples*: lumpy search structural variations inside and across two sequencing datasets from two samples

Analysis of sample replicates is not implemented yet in this wrapper

*BAM files*: Only BAM alignments produced by BWA-mem have been tested with this tool

**Sequencing method**

*Paired-end sequencing*: Both ends of library fragments have been sequenced, resulting in two paired sequencing datasets

*Single-read sequencing*: Only one end of library fragment has been sequenced, resulting in a single sequencing dataset. Under these conditions, evidences of structural variation are obtained only from splited read alignments

*Read length*: The length of the sequencing reads in the library. This information is required only for paired-end sequencing data

*Additional options*: refer to lumpy-sv_ documentation and the publication (doi 10.1186/gb-2014-15-6-r84)

**lumpy-sv manual**

Read the lumpy-sv_ documentation for details on using lumpy.

.. _lumpy-sv: https://github.com/arq5x/lumpy-sv

**lumpy options**

v 0.2.13
Author:  Ryan Layer (rl6sf@virginia.edu)

Summary: Find structural variations in various signals.

Options::
<![CDATA[

smoove calls several programs. Those with 'Y' are found on your $PATH. Only those with '*' are required.

 *[Y] bgzip [ sort   -> (compress) ->   index ]
 *[Y] gsort [(sort)  ->  compress   ->  index ]
 *[Y] tabix [ sort   ->  compress   -> (index)]
 *[Y] lumpy
 *[Y] lumpy_filter
 *[Y] samtools
 *[Y] svtyper
 *[Y] mosdepth [extra filtering of split and discordant files for better scaling]

  [Y] duphold [(optional) annotate calls with depth changes]
  [Y] svtools [only needed for large cohorts].

Available sub-commands are below. Each can be run with -h for additional help.

call        : call lumpy (and optionally svtyper)
merge       : merge and sort (using svtools) calls from multiple samples
genotype    : parallelize svtyper on an input VCF
paste       : square final calls from multiple samples (each with same number of variants)
plot-counts : plot counts of split, discordant reads before, after smoove filtering
annotate    : annotate a VCF with gene and quality of SV call
hipstr      : run hipSTR in parallel
cnvnator    : run cnvnator in parallel
duphold     : run duphold in parallel (this can be done by adding a flag to call or genotype)
]]>
    </help>

    <citations>
    <citation type="doi">10.1186/gb-2014-15-6-r84</citation>
  </citations>
</tool>
