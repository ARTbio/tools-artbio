<tool id="filter_cells" name="filter cells data" version="0.1.0">
    <description>on total aligned reads and/or number of detected genes</description>
    <requirements>
        <requirement type="package" version="1.3.2=r3.3.2_0">r-optparse</requirement>
        <requirement type="package" version="2.2.1=r3.3.2_0">r-ggplot2</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" level="fatal" description="Tool exception" />
    </stdio>
    <command detect_errors="exit_code"><![CDATA[ 
        Rscript $__tool_directory__/filter_cells.R 
            -f $input 
            --sep '$sep'
            --percentile_genes '$percentile_genes'
            --percentile_counts '$percentile_counts'
            --absolute_genes '$absolute_genes'
            --absolute_counts '$absolute_counts'
            --pdfplot $pdfplot
            --output $output
            --output_metada $output_metada
]]></command>
    <inputs>
        <param name="input" type="data" format="txt" label="Raw counts of expression data"/>
        <param name="sep" type="select" label="Indicate column separator">
            <option value="tab" selected="true">Tabs</option>
            <option value=",">Comma</option>
            <option value="\ ">Whitespace</option>
        </param>
        <param name="percentile_genes" value="0" type="integer" label="Detected Genes Percentile Threshold [integer] %"
               help="Cells with % of detected genes below this threshold will be filtered out. Leave at 0 for no filtering" />
        <param name="percentile_counts" value="0" type="integer" label="Aligned read count Percentile Threshold [integer] %"
               help="Cells with number of aligned reads below this % threshold will be filtered out. Leave at 0 for no filtering" />
        <param name="absolute_genes" value="0" type="integer" label="Absolute number of Detected Genes Threshold [integer]"
               help="Cells with number of detected genes below this threshold will be filtered out. Leave at 0 for no filtering" />
        <param name="absolute_counts" value="0" type="integer" label="Absolute number of aligned read Threshold [integer]"
               help="Cells with number of aligned reads below this absolute threshold will be filtered out. Leave at 0 for no filtering" />
    </inputs>
    <outputs>
        <data name="pdfplot" format="pdf" label="Plots from ${on_string}" />
        <data name="output" format="tabular" label="Cell data filtered with ${on_string}" />
        <data name="output_metada" format="tabular" label="Cell metadata filtered with ${on_string}" />
    </outputs>
    <tests>
        <test>
            <param name="input" value="none.tab" ftype="tabular"/>
            <param name="type_transfo" value="none"/>
            <param name="log" value="FALSE"/>
            <param name="visualisation" value="yes"/>
            <param name="seed" value="49"/>
            <param name="perp" value="10"/>
            <param name="theta" value="1" />
            <param name="tsne_labels" value="yes" />
            <output name="output" file="none.tab" ftype="tabular"/>
            <output name="tsne_out" file="none_tsne.pdf" ftype="pdf"/>
            <output name="pca_out" file="none_pca.pdf" ftype="pdf"/>
        </test>
    </tests>
    <help>

**What it does**


    </help>
</tool>
