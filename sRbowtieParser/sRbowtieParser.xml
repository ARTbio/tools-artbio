<tool id="sRbowtieParser" name="Parse items in sRbowtie alignment" version="0.9.0">
  <description></description>
  <requirements><requirement type='package'>bowtie-inspect</requirement></requirements>
  <parallelism method="basic"></parallelism>
<command interpreter="python">
        sRbowtieParser.py 
	          #if $refGenomeSource.genomeSource == "history":
                    $refGenomeSource.ownFile ## index source
         	    --do_not_extract_index
          	  #else:
            	    $refGenomeSource.index.fields.path   ## index source
            	    --extract_index
          	  #end if
		  $output
		  $polarity
		  #for $i in $input_list
    		    $i $i.ext "$i.name"
		  #end for

</command>
  <inputs>
       <conditional name="refGenomeSource">
           <param name="genomeSource" type="select" label="Will you select a reference genome from your history or use a built-in index?" help="Built-ins were indexed using default options">
               <option value="indexed">Use a built-in index</option>
               <option value="history">Use one from the history</option>
           </param>
           <when value="indexed">
               <param name="index" type="select" label="Select the reference genome used for the bowtie output" help="if your genome of interest is not listed contact the administrator">
                  <options from_data_table="bowtie_indexes"></options>
               </param>
           </when>
           <when value="history">
                <param name="ownFile" type="data" format="fasta"  label="Select the fasta reference" />
           </when>
       </conditional>  <!-- refGenomeSource -->
       <param name="input_list" type="data" label="Select multiple alignments to parsem" multiple="true"/>
       <param name="polarity" type="select" label="how to count sense and antisense reads">
         <option value="both">count both sense and antisense reads</option>
         <option value="sense">count only sense reads</option>
         <option value="antisense">count only antisense reads</option>
       </param>
   </inputs>
   <outputs>
   <data format="tabular" name="output" label="Read Count  Lists"/>
   </outputs>
  <help>

**What it does**

Parses read counts from one or several sRBowtie alignments (in tabular, Sam or Bam format).
Here a bowtie match done against an index composed of a set of items is parsed and expressed as a hit list of the corresponding items
Sense, antisense or both sense and antisense alignments can be counted
The library labels are infered from the input dataset names in the galaxy history.
**it is preferable that you do not put any space in this input dataset names. You may edit these names in the history**



  </help>
</tool>

